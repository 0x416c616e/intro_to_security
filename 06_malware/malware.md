# Malware

## What is malware?

Malicious software, or malware, is an umbrella term that means any software that does bad stuff. There are many different categories of malware, but malware is the most general term.

**Attack vectors and payloads** – an attack vector is how to get code execution on a device. A payload is what you run once you have a way to do RCE. Sometimes, an attack vector might be some advanced zero-day exploit, or it might just be emailing someone a maldoc and hoping they open it and enable macros.

**Maldocs** – malicious word documents and PDFs. Yes, even these kinds of files can be malicious. Word documents can be malicious through the use of word macros, which are ways of running commands in a word document. If a word document you opened from an email says “please enable word macros,” that’s a big red flag. It’s never a good idea to enable word macros. And PDFs can be malicious because of things like exploits for PDF readers that result in code execution. PDFs can also even run JavaScript. The reason why maldocs are especially problematic is because nobody trusts a .exe file, but many people think .docx or .pdf files are somehow safer. They really aren’t. 

**Malicious images** – many people think executables are the only kinds of files that can execute code. Sounds reasonable at first, until you realize that even images can be maliciously-crafted, such as to cause a buffer overflow and execute code in an image viewer. For example: https://www.cvedetails.com/vulnerability-list/vendor_id-2766/product_id-10713/Faststone-Image-Viewer.html

**Malware with logic bombs** – if you download and run something, and nothing bad happens immediately, then you might think it’s fine. But a lot of malware will use logic bombs. A logic bomb means that it stays dormant until either a certain date or until a certain condition is met. So right after you install something, it will seem benign. But a long time after you installed it, it might finally do something malicious.

**Keyloggers** – a program that logs keystrokes. Keyloggers can be used for spying and for stealing login information.

**RATs** – Remote Administrative Tools or Remote Access Trojans. RATs allow you to remotely control someone’s computer. Dark Comet and NanoCore are examples of RATs. 

**Spyware** – any type of malware that is used for spying on people is called spyware. There are many different types of malware that are classified as spyware. Spyware can do things like record keystrokes, do screen recording, take screenshots, view someone’s webcam, and more. 

**Rootkits** – software that allows someone to have persistent access to a machine, such as with a shell. A rootkit typically starts when a computer starts up. Rootkits try to hide themselves from their victim.

Nowadays, rootkit is used to describe malware for many different OSes, but the origin of the term is from Unix malware. root is the privileged user account in Unix. Unix was one of the first operating systems to take networking seriously, which was good in many ways, but also bad for security. 

**Kernel-mode rootkits** – a rootkit that affects the kernel of an operating system. 

**BIOS/UEFI rootkits** – a rootkit in the motherboard firmware of a computer. Older computers use BIOSes, and newer ones have UEFIs. On macOS, it’s called EFI rather than UEFI. BIOS stands for Basic Input and Output System. UEFI stands for Unified Extensible Firmware Interface. EFI stands for Extensible Firmware Interface. A BIOS/UEFI/EFI rootkit will start before the operating system boots up.

**GPU rootkits** – not a very common thing, but I heard about a proof-of-concept GPU rootkit called Jellyfish. It infects a graphcs card of a computer.

**HDD controller rootkits** – another uncommon but possible thing is for a hard drive’s controller to contain a rootkit.

**MBR rootkits** – more common than GPU or HDD rootkits, an MBR rootkit is a kind of malware that edits the Master Boot Record of a computer so that the rootkit can start up with the OS.

**Backdoors** – an intentional security weakness in something. For example, some people don’t trust Huawei because they claim there are backdoors in their products. It’s a difficult topic, because it’s hard to tell if a security flaw was accidental or intentional. 

**Compiler malware** – you trust your code, but what if your compiler is putting security weaknesses or malware into your compiled programs? The oldest example of this is the Ken Thompson hack. He intentionally put code in his compiler that would make login-related code weaker. Another example of compiler malware is XcodeGhost, which was a trojanized version of the Xcode IDE. Xcode is used for making iOS apps, such as for iPads and iPhones. Apps made using XcodeGhost would infect the iOS users who installed the apps. 

**Native malware** – malware that is natively installed on something. Think executables and operating systems. Usually written in C or C++.

**Browser-based malware** – malware that runs on a web page and infects a user through their browser. Usually JavaScript-based. Older browser-based malware would involve Adobe Flash or Java applets. In the future, browser-based malware might be WebAssembly-based.

**Mobile malware** – malware isn’t just for computers. There’s malware for phones too. One example of mobile malware is Dendroid, which is malware for Android phones. It was actually developed by someone who worked for a cybersecurity company called FireEye. 

**Router malware** – your router is a computer too, usually running some old version of Linux or some other Unix-based OS. If you haven’t updated your router’s firmware in a while, it might have malware that was able to be installed because of known vulnerabilities in the firmware. Firmware just means software that is intended for very specific hardware. For example, the firmware of a graphics card is the software that runs on it (not to be confused with device drivers, which are different). The OS and settings of a router are referred to as router firmware. The Mirai botnet would target home routers and IoT devices.

If you have a router or gateway (combination modem/router) from your ISP, they will probably update it for you. But if you own your own router, you need to keep it updated. You’d need to log into the web interface, such as 192.168.1.1 or something like that. Quite often, a manufacturer will stop supporting their older routers, and then if there’s a security issue with it, you can’t fix it… unless you install 3rd party router firmware, such as DD-WRT or OpenWRT, both of which are Linux-based. Or you can build your own router and install pfSense on it instead. 

**DNS malware** – DNS is responsible for figuring out which IP address to go to when you want to go to a certain domain name. DNS malware will use fake DNS to point you to malicious fake websites instead of the real thing. DNSchanger is an example of malware that changes your DNS.

**IoT malware** – malware for Internet of Things devices, a.k.a. smart devices. IoT devices are just appliances with computers in them. They are often running Linux, and often don’t get security updates. As such, they are a nice target for malware developers.

**POS malware** – Point Of Sales malware. When you go to a grocery store, they ring you up using something called a Point Of Sales (POS) terminal. It’s a computer. POS malware steals payment information. Target stores were compromised with POS malware in 2013.

**Skimmers** – instead of directly infecting a POS terminal with malware, someone might just put a device next to a credit card reader, such as the thing you use to swipe a card’s magnetic strip. A skimmer is a device that will “skim” the credit card info by being in very close proximity to it. Gas stations are notorious for having credit card skimmers. Skimmers are very compact and hard to see sometimes. They often use Bluetooth so that a criminal can read the contents of it from a mobile device. Skimmers are common because anyone can just buy one online and then put it at a gas station pump’s credit card reader. This is illegal and I don’t advise doing it, but what I’m saying here is that it’s a low-skill attack, because the people who use them don’t have to design them.

**Keyboard emulators a.k.a. BadUSB** – if someone can plug a USB device into your computer, it’s not secure, especially if your computer is unlocked, like if you go to the restroom and leave your laptop unlocked and unattended. BadUSB means a flash drive that has been reprogrammed to act like a keyboard. Because it’s not a keyboard, and it’s merely acting like one, it’s called a keyboard emulator. A computer will trust a USB keyboard that is attached to it. So a BadUSB device will send preprogrammed keystrokes to a computer, such as to open a terminal window and then use wget to download a rootkit. A keyboard emulator can input text much faster than a person can, so if an attacker has even a minute or so to be at your computer, they can plug in their preprogrammed BadUSB device, and then it quickly runs the payload, and by the time someone comes back to their laptop, it will already be done, and they won’t notice a thing.

This all comes back to the idea of physical security. If someone has physical access to your device, it’s not secure. It’s really that simple. If someone has physical access, they can do a password reset, using like NTPasswd (Windows), confreg (Cisco IOS), CMOS jumpers (motherboard passwords), etc. Not only that, but someone could also install something like a hardware keylogger.

**ICS/SCADA malware** – critical infrastructure uses computers to control things. As such, malware can be made for these kinds of systems.

**Persistent malware** – malware that stays on a device even if you reboot the device.

**Non-persistent malware** – malware that goes away when you reboot. Persistence is good for long-term spying or hacking, but at the same time, non-persistent malware can be sneakier and harder to investigate, because it won’t show up in files. A lot of malware is persistent, so reboots don’t usually do much of anything.

**Fileless malware (WMI hijacking)** – some fileless malware is non-persistent. It can be just a reverse shell running in RAM, or something simple like that. But when people refer to fileless malware, they are often referring to persistent fileless malware, as unintuitive as that might sound. If it has no files, how can it persist? Doesn’t that mean it’s only running in RAM? Well, actually, no. It turns out that files aren’t the only way to have something saved on storage… in Windows, at least. This is contrast to Unix, which has the philosophy of “everything is a file.” Of course, you can technically have fileless malware in Unix-based OSes too, if you count reverse shells, but they lack persistence across reboots.

In Windows, there’s something called the Windows Management Instrumentation, which lets you schedule events. WMI is a legitimate tool for task scheduling, but it can also be misused for bad things. WMI hijacking is when an attacker makes their malware run as a scheduled task in WMI. It won’t show up on the filesystem, just as a WMI event. It’s harder to detect, unless you use security software that specifically analyzes WMI stuff.

**Adware** – malware that gives you ads. 

**Ad fraud/fake views** – malware that gives websites and social media fake views, likes, and so on. Some people will pay for fake social media stuff in order to increase their online reputation, such as fake Youtube views, fake Instagram likes, fake Twitter followers, fake Twitch viewers, and so on. Because people can make money with views, and fake views are fraudulent, it’s called ad fraud. Some malware can do this stuff to make it seem as though someone from your IP address is watching videos. The thing about fake views is that, if all the views were coming from a couple IP addresses, it would seem fake. So people who do ad fraud want as many different IPs as possible. 

**Scareware** – rootkits are very stealthy and hide themselves from you. But some types of malware are not so secretive. Scareware is a category of malware that makes a window open with a scary message, such as saying you violated the law and you need to pay a fine, such as for copyright infringement. It will then tell you to pay for gift cards or prepaid debit cards and then enter in the code. It’s a scam. It’s called scareware because it’s all bark and no bite. Scareware commonly pretends to be from the FBI.

**Fake antivirus software** – while it’s true that there are plenty of legitimate antivirus programs out there, some of them are fake. Fake AV software is a type of scareware. It will tell you that your computer has serious problems, and you need to pay in order to remove them. In reality, the only malware on your computer might be the fake AV itself.

**Browser lockers** – a type of browser-based malware that stops you from closing your browser. It will tell you that there is a problem with your computer and that you need to call a number to have it fixed. The good news is that browser lockers are not persistent. Even if you can’t close the window, you can just restart the computer. Then just remove the browser locker site from your browser history. Unlike something like a RAT or rootkit, browser lockers are not persistent. If your browser starts up when your computer boots up, leading to a loop of the browser locker opening every time you restart your computer, then just reboot into safe mode rather than normal mode.

**Safe mode** – a minimal way to boot up Windows. It means that you only load the bare essentials, and not other programs. Safe mode can be important when you’re trying to get rid of malware. Back when I did computer repair and refurbishing, I’d often have to deal with people’s computers that had malware.

I’d boot a computer into safe mode and then run Malwarebytes (and sometimes other programs like Spybot Search & Destroy – it was a long time ago), with a custom scan that checks all drives and checks for rootkits (the “check for rootkits” option in Malwarebytes makes it take longer, but it finds more stuff). 

In the couple of times that I accidentally just ran Malwarebytes in normal mode, I came across malware that could reestablish persistence, even if it seemed like Malwarebytes got rid of it. So safe mode was really important for being able to get rid of malware. 

If malware is really bad, you might want to just reformat a drive and then reinstall the OS. But safe mode and Malwarebytes is a decent way to try and salvage an OS installation, especially because many customers are picky about their files and software settings. It’s also good to change your passwords. If it was financial malware that steals banking info, it might also be good to either do a credit freeze or credit monitoring for a while. Maybe also contact your bank and let them know, and maybe get a new credit card and/or debit card.

Even if you backup someone’s files, then reinstall an OS, and then reinstall the programs they had before and put their files back, someone might be upset that their desktop icons are in a different spot from before. People can be very picky about seemingly unimportant things.

**Cryptocurrency miners** – a program that uses up CPU and/or GPU resources in order to mine cryptocurrency for someone else. It will make your computer very hot and slow. 

**Trojans** – a common thing is for file sharing sites (such as torrent trackers) to offer free versions of software, movies, and games – which usually cost money. A trojan is a piece of malware that is added to something legitimate. If someone pirates a video game, and the video game works as expected, they probably won’t suspect a thing, even if it’s trojanized and doing something bad in the background. Combine torrent trojans with logic bombs, and you’ll end up with situations where a lot of people leave feedback on a torrent saying that it’s legit, because there’s a delay between when they install it and when it does bad stuff (because of the logic bomb).

**Trojanized pirated software on torrent trackers** – want Photoshop, but don’t want to pay for it? There are torrents that can let you download it for free. However, this is illegal, as it’s copyright infringement. Not only that, but if something is free, there’s usually a catch. In software piracy, the catch is hidden malware. Peer-to-peer file sharing is a haven for malware. Trojans are very common in torrents. A torrent tracker is a site that tracks many different torrents. 

Piracy isn’t worth it. If you really want something like Photoshop, but for free, then look into free legitimate alternatives, such as GIMP or Krita, which are free image editing programs that you don’t have to pirate. Or just pay money for the premium software. Pirated software isn’t really “free” if you consider the cost of something like credit card fraud, ransomware, or having your privacy violated because of hidden spyware. 

That being said, a lot of software these days is free to use anyway, and then just has microtransactions or advertisements in the app, so piracy is less relevant as time goes on. 

**Trojanized hacking tools** – if you google “how to hack” or “how to use kali linux” or something, you might find some really bad tutorials. A common thing is for someone to make a mediocre video tutorial explaining the basics of some security-related tool, and then in the video description, they’ll have a download link to what they claim is the legitimate tool. But in reality, it’s a trojanized version of the tool, so even though the tool might work as intended, it has hidden malware in it, which can steal your keystrokes or record your screen, or something like that.

This doesn’t make much sense at all, considering that a lot of industry-standard security tools are free and open source. But the people that make these trojanized versions are preying on people who don’t really know much about security tools at all. 

If you search for something like “how to hack” instead of “server-side request forgery” then you’ll find worse results.

**Man-in-the-browser (MITB)** – malware that infects web browsers for man-in-the-middle attacks for a user’s web browsing.

**Domain-generating algorithms** – malware will often communicate with servers using domain names. But if a malware analyst can reverse engineer it and see which domains it’s trying to connect to, it can be easy to just block those domains, or even contact the domain registrar and tell them about how that domain is being used for malicious purposes. So malware developers got clever and got around this issue by coming up with DGAs, or domain-generating algorithms. A domain-generating algorithm will generate seemingly gibberish domain names. Because they are constantly changing, it’s harder to stop. 

It’s easy to block a single known malicious domain that looks something like this:

```
evilwebsite.com
```

But it’s harder to block thousands of domain names that look like this:

```
ymvbnzlscqjdgrxu.com
vswfrglbvoovctev.com
oyypkesydfxdephl.com
ogcbotsiawfqzgfd.com
axqffqaoxybtgvnc.com
ufyxlbembxskicso.com
pizrvbunvduqhmkf.com
bxknlmbqwfeftxwo.com
rdflftfjwseiavtw.com
cfvwjndlgmcgmsav.com
hdnmedtjtsvezhba.com
```

**ATM malware** – malware for ATMs. Two examples of ATM malware include Tyupkin and GreenDispenser. 

**Banking malware** – malware that tries to find and steal banking information. Shifu and Dridex are examples of banking malware.

**Email spammers** – a type of malware that sends out emails. The emails might be about scams, bootleg pharmacies, phishing, or sending people to malicious links. Some email scams are intentionally dumb-sounding because they’re trying to target old people with dementia, rather than younger people without mental issues. This is because old people might have a lot of money saved up for retirement, and they might not be all there mentally. So if you can figure out that a spam email is not legitimate, then you’re not their target audience. Even if only one in a million people falls for such a scam, they send out billions of emails, so they do succeed every now and then. 

If email spam was just being sent from a couple spammers’ servers, it wouldn’t be that bad. But a lot of malware on compromised computers will send out emails, making it harder to stop. Many botnets are used for email spam.

**Viruses** – malware that can spread itself. A virus might email itself to someone’s contacts. Viruses are not very common. The term “virus” is misused a lot of the time. Even “antivirus software” is an inaccurate name. Some types of malware are viruses, but most malware is not. All viruses are malware, but not all types of malware are viruses. It would be more accurate to call antivirus software anti-malware software, but the incorrect usage has become almost canonical now. 

**Bots and botnets** – a botnet is a network of bots. Bots are computers that accept commands from an attacker. 

Some well-known botnets include Zeus, Pony, Cutwail, Necurs, Storm, Mirai, Hajime, Kraken, and Srizbi. Some botnets get taken down, but it’s a game of whack-a-mole.

**C2** – command & control. A botnet command & control server is the server that controls the bots. It’s also called C2. C2 can refer to either a C2 server or C2 traffic. C2 traffic is the communication that involves botnet owners and bots. Tor is sometimes used for C2 traffic. If you’re a system administrator, you should block Tor, for inbound and outbound.

**IRC bots** – an older style of bots which use a chatroom protocol called IRC (Internet Relay Chat) in order to send and receive data. EggDrop is an example of an IRC bot. IRC bots are chat bots and aren’t necessarily bad, but they can be used in a bad way by botnets. 

**HTTP bots** – a newer style of bot that uses the HTTP protocol for communication. 

**Web shells** – a shell that can be used in a web browser and typically runs on a web server, such as a LAMP server that had a file upload vulnerability. China Chopper, WSO shell, and C99 shell are examples of web shells.

I wrote a simple PHP web shell. You can see it on GitHub:

<https://github.com/0x416c616e/php_web_shell>

**Reverse shells** – a shell that connects from a victim machine to an attacker’s machine. The victim machine initiates the connection. A reverse shell automatically tries to connect to an attacker who is in a remote location.

**Bind shells** – a shell that an attacker can connect to. The attacker has to initiate the connection from the attacker machine to the victim machine. A bind shell is waiting and listening for connections from the outside world. In many cases, bind shells might not be possible because of strict ingress firewall rules, which will block connections initiated from the outside world.

**Meterpreter shell** – a type of shell associated with Metasploit.

**msfvenom** – a tool for generating payloads in Metasploit.

**Veil a.k.a. Veil framework** – formerly known as Veil Evasion, Veil is a tool that can make Metasploit payloads that antivirus software can’t detect.

**Worms** – malware that spreads itself over a network, moving from one device to another. Worms require things like remote code execution vulnerabilities, so they are quite rare. The SQL Slammer worm was a famous worm. Unlike a malicious link, which a user needs to click on, a worm typically doesn’t require any user interaction at all. So people who give terrible security advice like “just don’t click on anything and you’ll be fine” really don’t know what they’re talking about. It’s true that some types of malware require user interaction, but some don’t require any at all, so there are additional security measures that need to be taken, such as network segmentation, patching, and minimizing the number of listening services on a device.

**Ransomware** – malware that encrypts someone’s files and then demands money (a ransom) in order for the user to get the decryption key so that they can get their files back. Ransomware might generate an encryption key and then send it to a Tor hidden service. Ransomware typically asks the user to pay using a cryptocurrency such as Bitcoin. When they pay, they will be able to get the decryption key from the Tor hidden service. Some ransomware is fake, and won’t decrypt files at all. Other kinds of ransomware are lazily programmed, and instead of involving complicated randomly-generated encryption keys and Tor hidden services, it might just have a hard-coded key that is the same for all of them. It’s never a good idea to pay the ransom, because you’ll be funding crime and encouraging them to do it again. If someone doesn’t make money with ransomware, they won’t keep on doing it. But if victims pay the ransom, they will keep on doing it because it’s profitable. Unfortunately, many people actually do pay the ransoms, and that’s why ransomware is popular among cyber criminals. Unlike something like a keylogger, which can be harder to monetize, ransomware is less about spying and more about just trying to make as much money as possible with the least amount of effort. Unlike something like a rootkit, ransomware makes itself known to the user, with a window that pops up and tells them that they have something like 72 hours in order to pay the ransom before the decryption key is lost forever.

The way to combat ransomware is to use versioned backups that are read-only. Some ransomware can encrypt files in network locations, such as a network-mapped drive, so that’s why it’s important to have file versioning, as well as making older backups read-only, unable to be modified by the user or any ransomware they might get.

Some examples of ransomware include WannaCry and NotPetya. There is even a free and open source ransomware project on GitHub called Hidden Tear.

**Wormable ransomware** – ransomware that can spread itself over a network, from one computer to another. Instead of only giving a single computer ransomware, it tries to encrypt the files on every computer within a network. WannaCry is an example of wormable ransomware.

**Crimeware** – software used for cybercrime. Instead of writing your own crimeware from scratch, you can buy crimeware on the dark web. There are many different types of crimeware, but the main purpose of pretty much all crimeware is to make money, such as through stealing bank account details and making fraudulent charges. Crimeware that is designed to be easy for low-skilled attackers to use is called Crimeware as a Service. Just like how IaaS or PaaS makes things easier for legitimate developers, CaaS can make it easier to be a cybercriminal. 

RaaS, or Ransomware as a Service, is a popular type of crimeware. A criminal will pay a RaaS developer so they can use their ransomware. Then, all the low-skilled attacker has to do is get people to run their payload, which will encrypt their files and demand that they pay a ransom in order to decrypt them. The Sodinokibi RaaS has made its users a combined total of about $2 billion. 

Hackers can use Kali Linux and Metasploit instead of writing their own tools. Full stack web developers can use a premade stack and server program, like LAMP or MEAN or Django or something, rather than making their own web platform themselves. Cybercriminals can use crimeware instead of making their own stuff from scratch. 

Crimeware is illegal, violating the CFAA, or Computer Fraud and Abuse Act. Don’t look into crimeware. However, Kali Linux and Metasploit are legal tools, but only if you only use them on your own servers, such as a test lab VM for a class or a self-paced thing. But these tools are illegal to use on anyone else’s stuff. 

**In-your-face malware vs. stealthy malware** – I’ve dealt with less tech-savvy people who didn’t understand the concept of hidden malware. When I’d mention finding stuff on their computer using Malwarebytes, they’d say “but I didn’t see anything” or something along those lines. But here’s the thing: there’s plenty of software running on a computer that doesn’t make itself known to you. Many legitimate processes called daemons are running in the background. Lots of software is system-related or just doesn’t run in a window that you can see. So don’t get the wrong idea and think that malware only exists if it opens a window that you can view. Ransomware might be one of the more visible kinds of malware, but there’s still plenty of malware that tries really hard to remain undetected. And keep in mind that antivirus software isn’t perfect. Not everything gets detected.

**Wipers (such as Shamoon)** – some types of malware are just plain destructive. A wiper is a piece of malware that is intended to wreak havoc, such as by deleting files and wiping drives, which can delete important information and delete software files which will stop things from working correctly. Shamoon is a well-known example of a wiper. Unlike ransomware, which hurts the victim but makes money for the criminal, a wiper doesn’t make an attacker richer. The purpose of a wiper is simply to hurt someone.

**Polymorphic malware** – old-school methods of detecting malware included looking for files with certain checksums, finding processes with certain names, and things like that. But polymorphic malware is malware that is slightly different from one machine to the next, making it harder to develop signatures for it. A signature is properties of a known malicious file, such as its filesize, checksum, filename, location, process name, and maybe even things like domains it connects to. But polymorphic malware changes itself, making it harder to detect. 

**Malware families** – if there are many different variations of the same kind of malware, it’s called a malware family. If a security company says they “detected millions of new pieces of malware” in a given year, they might really only be finding a few malware families that have many variants. 

Not only can there be polymorphic variations or spinoffs of a kind of malware, there can also be updates, just like how an app or OS can get updated too. 

Here’s an example of how Microsoft refers to a given piece of malware:

```
TrojanSpy:Win32/Shifu.A
```

It first lists the kind of malware that it is, followed by the platform, then the name, and then the variation. If there was another version, it would be called Shifu.B, and then Shifu.C, then Shifu.D, and so on.

**Steganographic malware** – malware that tries to hide itself in a tricky way. 

**Obfuscated malware** – malware that makes itself harder to read/understand/detect. Non-obfuscated source code is source code that a software developer can read. Obfuscated source code is not human-readable. 

**Minifiers** – a tool that can be used either legitimately or maliciously. It “minifies” code, making it more compact, but also harder to read. Minifiers are often associated with JavaScript. Minifiers are used legitimately with web development to make a web page have a smaller file size, which will make it load faster. 

**Droppers** – a small program whose only purpose is to download additional stages of malware. Advantages of using a dropper include that it’s very small in size (which can be useful for email attachments or trojans), being harder for antivirus software or email attachment scanning software to detect as malicious, and that it can also possibly check for certain conditions before proceeding with downloading the next stage of malware. 

**Exploit kits** – a piece of software that allows an attacker to get a foothold on a victim’s computer. This can be achieved through things like browser (or browser plugin) exploits that allow for code execution. When people still used Adobe Flash, flash-based exploit kits (also called EKs) were very popular, because then you could make a web page with an EK .swf file, and the EK could let you execute code on someone’s machine, and all they had to do was load the web page that had the malicious EK-based flash file on it. But flash is less and less popular these days, so EKs have to do other things instead.

Some examples of exploit kits include Angler, Magnitude, Fallout, KaiXin, Disdain, Sundown, Rig, Blackhole, Neutrino, and more. EKs typically cost a lot of money (from hundreds to thousands of dollars per month), but people who pay for them can still make money. What someone will do is combine an EK with a malicious payload, such as ransomware, and then put it on a website that they hacked, such as a local business’s website that is running an old version of Wordpress. Then they can do something like rent a botnet to spam tons of people with emails with a link to the website. Many people will have spam filtering software filter it out and will never even see it, but some people use email that doesn’t have great spam filtering, and some who see it will click on it, load the EK, some won’t have software that is vulnerable to the EK’s exploits, but many will. Then most of the people won’t pay the ransom, but the ones who do will make it worthwhile for the criminal. So it takes spamming a huge number of email addresses to get a small number of people who will actually fall for it, but even so, criminals can make a lot of money this way. 

Some EK developers have been arrested, but many are still operating. Again, it’s a game of whack-a-mole. There is clearly demand for premade exploits, so people who do exploit research can just sell their exploit software to people who want to mass mail people stuff in order to get some people to run their malware, keyloggers, RATs, or whatever else. 

**Java drive-by** – an older type of attack that involved browser-based Java applets, which don’t exist anymore. You used to be able to run Java code inside of a web browser, rather than having to download and run a Java program. But because of security issues with Java applets, they were killed off entirely. Java still exists, and it’s very good and useful, but browser Java applets were not. Java applets and Adobe flash had similar issues.

A Java drive-by attack, or drive-by download, is a malicious Java applet in a browser. A criminal would link a victim to their malicious web page, and when the victim clicked it, the malicious applet would load and run its code.

**Zip bombs** – a security issue relating to .zip archives. You can zip up files in compressed archives, like .zip or .rar. It can save space and also make it easier to package up a bunch of files that are all part of a single project, such as an app you’re working on. But a zip bomb is a malicious zip archive. A zip bomb file might be very small, but if you try to unzip it, it could take up all your free space on your drive, or slow down your computer when it’s unzipping it, or even crash it.

**Exploits and instability** – an exploit makes use of a software bug for security attacks. Because exploits make use of bugs, sometimes trojanized software can be less stable, or opening a malicious file in some other program might cause it to crash. Sometimes, crashing is because of bugs or instability, but other times, crashing can be because of malware that uses security exploits. If a program crashes and it asks if you want to send a crash report to Apple/Microsoft/Mozilla/whoever, it’s not just about stability. Submitting a crash report might help them identify malware (assuming that it crashed because of malware rather than just a typical stability issue).

**Stolen code signing** – programs can sometimes be “signed,” meaning they are verified to be trusted, using a certain developer’s name. If a hacker steals a legitimate developer’s code-signing capabilities, they can “sign” malware to make it look more legitimate.

**Traffic distribution system (TDS)** – would it make sense to try and get a Linux user to download your Windows malware? Would it make sense to try and give a Mac user your Android malware? No. That’s where a traffic distribution system comes into play. In typical web development, if someone requests a page, they get a response. There’s often a 1:1 mapping of requests to responses. But in a TDS, the response to a request (such as a victim clicking a link in an email or social media DM) might be conditional. What is their user agent? What is their operating system? Things like that. A TDS lets someone conditionally give different responses or payloads to people based on certain criteria. Two examples of traffic distribution systems are KeitaroTDS and BlackTDS. Some people claim that TDSes are legitimate tools for marketing, and that just because malicious people use them doesn’t mean they’re always malicious. But even so, cybercriminals love TDSes, even if some people think they’re legitimate tools. 

**Petty profit-oriented malware** – most malware is just a way for criminals to make money. That’s all there is to it. 

**Malware for personal spying** – some malware is made for people to spy on other people. Sometimes, if someone suspects that their spouse is cheating on them, they might install spyware on their computer and see what they’re doing on it. In this case, they’re doing it to gain information rather than to make money. Even though it’s not the same as something like ransomware, it’s still sinister and illegal. 

**Joke/prank malware** – back in the day, when very few people had computers and they were more for hobbyists rather than everyday stuff (maybe the 80s or 90s), malware was more about pranks instead of making money. But this is no longer the case. Nobody makes silly harmless prank malware anymore, because there are so many ways to make money with it now. Prank malware might play silly sounds, show you silly images, or otherwise just mess with you. But prank malware also makes itself known to the user. Nowadays, most malware, aside from ransomware, will try to hide itself from the user, with no noticeable effects whatsoever. 

**Hobbyist/educational malware** – some software developers write apps because they’re bored or just to see if they can. In that case, it’s not the same as serious malware, because someone is just doing it for the experience of writing it. Educational malware is a similar topic, since it’s malware that is intended to be used for educational purposes rather than malicious stuff. Of course, saying “this is for educational use only” won’t stop people from misusing it. 

**Hacktivist malware** – a hacktivist is someone who hacks for political reasons. They might use security exploits for hacking, and tools like Tor, nmap, Kali Linux, Metasploit, Burp Suite, The Social-Engineer Toolkit, and so on. They might also use malware in addition to scanning and exploits. Hacktivists are motivated by politics, not money. As such, a hacktivist might try to get a politician they dislike to do something like open an email attachment, so that they can establish persistence on their computer to see what they’re doing.

**Nation-state malware** – malware that is developed by nation-state groups. A nation-state hacking group is called an Advanced Persistent Threat, or APT. They might just use standard tools, or they might write their own. Or some combination of the two. Because attribution of hacking is difficult, APTs are often referred to by a number, such as APT20. Nobody knows who they really are, but security researchers can guess, based on their capabilities, that they are government-backed groups rather than lone wolves.

**Nation-state attacks and political extortion** – instead of just trying to get money from random people by encrypting their files and demanding ransom, some people might try to make money or gain power by hacking politicians, getting dirt on them, and then blackmailing them. If a hacking group wants to have influence in a certain country, they can just try to get a politician to click a link that will give them spyware.

**Packers** – a way to make an executable smaller. Malware should be small, so that it can be in an email attachment, a small payload from some browser-based code execution exploit, or a trojanized version of some other file. The smaller malware is, the better.

**Crypters** – crypters obfuscate malware, and the goal is to make them undetectable by security software.

**Protectors** – software that can make it harder for a malware analyst to reverse engineer malware.

**Portable executables (PE)** – a way to make malware portable. You can’t have your malware be in a folder with a lot of different files. It needs to be a single executable file, with everything self-contained. And it can’t require something like Python or Java either, because people might not have them installed. So it needs to be something like C or C++, and needs to be portable. Nobody’s going to click through an installer to install malware. It has to run right from an executable.

**PEid** – a tool for identifying portable executables.

**Gray area malware** – some malware is obviously malicious, such as a banking trojan that tries to steal banking information, which will then be used fraudulently so that the criminal can make money by stealing someone else’s money. But some malware is less harmful, sometimes to the point that it’s hard to decide if it’s malware or not. For instance, some people might argue that Facebook is spyware.

**Potentially Unwated Programs (PUPs)** – not necessarily malware, but when you install a program in Windows, it might ask if you also want to install something else. The developer of a program you like might be paid to include a “would you also like to install this other program?” feature in their program’s installer.

The program might be legitimate, in the sense that it’s not going to steal your account information, but it might be something you don’t want. Maybe a program’s install wizard will ask if you want to install another program, and you just click “next” without reading it or paying attention to what it’s installing. Maybe it’ll install a toolbar or antivirus program. It might be a legitimate product, but it might be a free trial for something that will eventually ask you to pay for a subscription. In that case, it’s not really malware, but it’s something that is potentially unwanted, hence potentially unwanted program, or PUP. Compared to other kinds of malware, PUPs are usually more tame. 

**Polyglot files** – a file that is valid in multiple types. A PNG image file that is also a compiled C++ executable is an example of a polyglot file. Polyglots are used in malware. If you’ve ever seen an image on your computer that looks like random static, it might be a polyglot file used by malware.

**Anti-analysis software** – some malware is shy and doesn’t want to be seen. Before doing something like connecting to a server or doing anything malicious, some malware might try to see if it’s in an analysis environment before doing anything. If it thinks that it’s being analyzed by a malware researcher, such as in a sandboxed environment like a virtual machine, it might refuse to run. 

**Beacons** – when a computer infected with malware attempts to reach out to a malware-related server, it’s called a beacon. A beacon is when malware lets a malware controller know that it was installed and exists, which can be useful if the attacker wants to send the software commands. 

**Stuxnet** – a sophisticated piece of malware, developed by nation-states, which targeted power plants. It’s a newer and more hardcore version of malware, which is intended to have effects in the real world. Stuxnet attempted to sabotage nuclear power plants by making the reporting software report that everything was okay even when it wasn’t. This is much more dangerous than something like a rootkit or keylogger, because it’s attempting to make nuclear power unstable. This new type of malware, which is intended to have repercussions in the “real world” rather than just on a computer or on the internet, is very serious. Because of its complexity, people have concluded that Stuxnet must have been developed by governments, not individuals. It’s too sophisticated to be from petty criminals who are just out to make a quick buck. 

Go to the previous section:

<https://github.com/0x416c616e/intro_to_security/blob/master/05_cybercrime/cybercrime.md>

Go to the next section:

<https://github.com/0x416c616e/intro_to_security/blob/master/07_known_vulns/known_vulnerabilities.md>

